# SOC Playbook: Malware Detection & Response

## Purpose
Provide a standardized process for detecting, investigating, and responding to suspected malware activity within the environment.

---

## Alert Triggers
- Malware alert from SIEM or EDR
- Suspicious process execution (e.g., PowerShell, encoded commands)
- Known makicious hash detection
- Unexpected outbound network connections

---

## Initial Triage
1. Validate alert source and severity
2. Identify affected host(s) and user account(s)
3. Determine malware type (trojan, ransomware, downloader, etc.)
4. Check timestamp and scope of activity

---

Investigation Steps
- Review process creation logs (Event ID 4688)
- Inspect command-line arguments
- Check parent-child process relationships
- Review file hashes against threat intelligence sources
- Analyze network connections (C2 indicators)

---

## Containment Actions
- Isolate affected host via EDR or network controls
- Block malicious IPs/domains at firewall or proxy
- Disable compromised user accounts if necessary

---

## Eradication
- Remove malicious files
- Terminate malicious processes
- Patch exploited vulnerabilities
- Reset credentials associated with affected host

---

## Recovery
- Restore systems from known-good backup if required
- Re-enable host network access after validation
- Monitor system for re-infection

---

## Post-Incident Actions
- Document inceident details and timeline
- Update detection rules if needed
- Review security controls effectiveness
- Share lessons learned with SOC team

---

## MITRE ATT&CK Mapping
- Execution: T1059 (Command and Scripting Interpreter)
- Persistence: T1547 (Boot or Logon Autostart Execution)
- Command and Control: T1071 (Application Layer Protocol)

---

## Severity Levels
- Low: Single user, no compromise
- Medium: Multiple users targeted
- High: Confirmed credential compromise or malware execution

---

## Escalation
Escalate to Tier-2 if:
- Malware persists after containment
- Priveleged account impacted
- Evidence of lateral movement
